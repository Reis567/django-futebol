{% extends 'base.html' %}
{% load static %}

{% block content %}
    <div class="container">
        <h2>Criar Novo Time</h2>
        <form method="POST">
            {% csrf_token %}
            {{ form.non_field_errors }}

            <div class="form-group">
                <label for="nome">Nome do Time:</label>
                {{ form.nome }}
            </div>

            <div class="form-group">
                <label for="sigla">Sigla do Time:</label>
                {{ form.sigla }}
            </div>

            <div class="form-group">
                <label for="tecnico">Nome do Técnico:</label>
                {{ form.tecnico }}
            </div>

            <!-- Pesquisa por nome e posição -->
            <div class="form-group">
                <input type="text" id="pesquisaNome" class="form-control" placeholder="Pesquisar por nome">
                <select id="pesquisaPosicao" class="form-control mt-2">
                    <option value="">Filtrar por posição</option>
                    <option value="GOL">GOL</option>
                    <option value="DEF">DEF</option>
                    <option value="MEI">MEI</option>
                    <option value="ATA">ATA</option>
                </select>
            </div>

            <div class="form-group">
                <label for="jogadores_titulares">Jogadores Titulares:</label>
                {{ form.jogadores_titulares }}
            </div>

            <div class="form-group">
                <label for="jogadores_banco">Jogadores Banco:</label>
                {{ form.jogadores_banco }}
            </div>

            <button type="submit" class="btn btn-primary">Criar Time</button>
            <a href="{% url 'home' %}" class="btn btn-secondary">Cancelar</a>
        </form>
    </div>

    <style>
        .container {
            margin-top: 30px;
        }
        h2 {
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .btn {
            margin-top: 10px;
        }
    </style>

    <script>
        // Filtragem por nome
        document.getElementById('pesquisaNome').addEventListener('input', function () {
            const valorPesquisa = this.value.toLowerCase();
            const opcoesTitulares = document.querySelectorAll('#id_jogadores_titulares option');
            const opcoesBanco = document.querySelectorAll('#id_jogadores_banco option');

            opcoesTitulares.forEach(opcao => {
                const texto = opcao.textContent.toLowerCase();
                opcao.style.display = texto.includes(valorPesquisa) ? '' : 'none';
            });

            opcoesBanco.forEach(opcao => {
                const texto = opcao.textContent.toLowerCase();
                opcao.style.display = texto.includes(valorPesquisa) ? '' : 'none';
            });
        });

        // Filtragem por posição
        document.getElementById('pesquisaPosicao').addEventListener('change', function () {
            const valorPosicao = this.value;
            const opcoesTitulares = document.querySelectorAll('#id_jogadores_titulares option');
            const opcoesBanco = document.querySelectorAll('#id_jogadores_banco option');

            opcoesTitulares.forEach(opcao => {
                const texto = opcao.getAttribute('data-posicao');
                opcao.style.display = texto === valorPosicao || !valorPosicao ? '' : 'none';
            });

            opcoesBanco.forEach(opcao => {
                const texto = opcao.getAttribute('data-posicao');
                opcao.style.display = texto === valorPosicao || !valorPosicao ? '' : 'none';
            });
        });
    </script>
{% endblock %}
